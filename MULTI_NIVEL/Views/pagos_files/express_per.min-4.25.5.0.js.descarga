//express_per-4.25.5.0.js
var merchantName, orderNumber, purchaseAmount, popupBank, external = {}, agentesSortOrder = ["1005_CASH_AG", "1001_CASH_AG", "1001_CASH_KSNT_AG", "1011_CASH_AG", "1006_CASH_AG"]; function saveVisitorIsClickReturn() { ExpressCommon.prototype.returnToMerchant(), $.ajax({ url: expressCommon.urls.SaveReturnToMerchant, type: "POST", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { }, success: function () { } }) } !function () { function e(e, t) { var i = { step: e, tokenId: window.viewModel.TokenId, countryId: window.viewModel.SelectedCountryId, PaymentChannelCode: t, channelId: window.viewModel.SelectedChannelId }, a = JSON.stringify(i); $.ajax({ url: expressCommon.urls.GetRenderProviderContent, type: "POST", data: "{'data':'" + a + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function (e) { viewModelDynamicContent.WorkingStatus(2), o() }, success: n }) } function n(e) { var n = JSON.parse(e.ViewModel); 0 === e.ErrorNumber ? (viewModelDynamicContent.WorkingStatus(n.BankWorkingStatus || 2), o()) : function (e, n) { var o = expressCommon.getErrorMessage(e.ErrorNumber); "" === o && (o = e.ErrorDescription); viewModel.ErrorNumber = e.ErrorNumber, viewModel.ErrorDescription = o, expressApp.showErrorPage(n, e.PaymentChannelError) }(e, window.viewModel.SelectedBankId) } function o() { var e = b(); e && (0 != viewModel.ErrorNumber && expressApp.showErrorPage(e.BankId, viewModel.PaymentChannelError), e.Content && (external.htmlContent = e.Content), e.AmountInvalid ? (viewModelDynamicContent.IsValidAmountLimit(!1), viewModelDynamicContent.MaxLimitValue(e.MaxLimit)) : (viewModelDynamicContent.IsValidAmountLimit(!0), viewModelDynamicContent.MaxLimitValue(0))); var n = $(".link-wrapper .seleccionado").data("paymentCode"), o = viewModelDynamicContent.Country.Banks, t = $.grep(o, function (e) { return e.PaymentChannelCode == n }); t.length > 0 && t[0].AmountInvalid ? (viewModelDynamicContent.IsValidAmountLimit(!1), viewModelDynamicContent.MaxLimitValue(t[0].MaxLimit)) : (viewModelDynamicContent.IsValidAmountLimit(!0), viewModelDynamicContent.MaxLimitValue(0)), $("div.pasos_wrapper").html(external.htmlContent); var i = $("div.pasos_wrapper").get(0); ko.cleanNode(i), ko.applyBindings(viewModelDynamicContent, i), external.initBankContent(), function () { if (external.savedTime && external.savedTime.length) { var e = new Date, n = external.savedTime[3], o = Math.floor((n.getTime() - e.getTime()) / 1e3), t = 60 * external.savedTime[0] * 60 + 60 * external.savedTime[1] - o + +external.savedTime[2]; viewModelDynamicContent.LeftTime.Hours = Math.floor(t / 3600), viewModelDynamicContent.LeftTime.Minutes = Math.floor(t % 3600 / 60), viewModelDynamicContent.LeftTime.Seconds = t % 60 } }(), contador_tiempo("timer_hor_1", "timer_min_1", "timer_seg_1"), 1 === viewModel.ProductID ? (expressCommon.setCashPaymentUrl("tabCash"), g()) : (expressCommon.setOnlinePaymentUrl("tabOnline"), D()) } function t() { for (var e = $.cookie("CkBank"), n = $("div.SeleccionFinanciera-item.slick-slide"), o = 0; o < n.length; o++) { var t = $(n[o]).find("a[id=" + e + "]"); if (0 === o) { if (0 !== t.length) break; $("i.fa.fa-chevron-right").click() } else { if (0 !== t.length) break; $("i.fa.fa-chevron-right").click() } } $("#" + e).click() } function i() { viewModel.countryName = viewModel.CountryDefaultId, viewModel.availableCountries = ko.observableArray(), viewModel.selectedCountry = viewModel.CountryDefaultId, viewModel.IsVolaris = "5162" === viewModel.MerchantCode, viewModel.Flag = viewModel.CountryDefaultId.toLowerCase(), viewModel.errorNumber = ko.observable(viewModel.ErrorNumber), viewModel.errorDescription = ko.observable(viewModel.ErrorDescription), viewModel.countryName = viewModelDynamicContent.Country.CountryId, viewModel.availableCountries = ko.observableArray(function (e) { var n = []; if (null === e) return n; for (var o = 0; o < e.length; o++) n.push(new a(e[o])); return n }(viewModelDynamicContent.CountryList)), viewModel.SupportedCashChannel = expressCommon.evaluateSupportedCashChannel(), viewModel.SupportedOnlineChannel = expressCommon.evaluateSupportedOnlineChannel(), viewModel.SelectedCountryId = viewModelDynamicContent.DefaultCountryId, viewModel.SelectedCurrencyId = viewModelDynamicContent.DefaultCurrencyId, viewModel.SelectedChannelId = viewModelDynamicContent.DefaultChannelId, viewModel.SelectedBankId = viewModelDynamicContent.DefaultBankId, viewModel.ShowBanksInNewWindows = viewModelDynamicContent.ShowBanksInNewWindows, viewModel.ShowExpirationTime = viewModelDynamicContent.ShowExpirationTime, viewModel.ShowReservationNumber = viewModelDynamicContent.ShowReservationNumber, viewModel.ShowReturnToMerchantLink = viewModelDynamicContent.ShowReturnToMerchantLink, viewModel.ShowWorkingHours = viewModelDynamicContent.ShowWorkingHours, viewModel.MerchantReferenceText = null == viewModelDynamicContent.MerchantReferenceText || void 0 == viewModelDynamicContent.MerchantReferenceText ? "" : viewModelDynamicContent.MerchantReferenceText, viewModel.ShowMerchantBranding = function () { if (null === viewModel.MerchantBranding || void 0 === viewModel.MerchantBranding) return !1; if ("5347" !== viewModel.MerchantCode && "5640" !== viewModel.MerchantCode && "4526" !== viewModel.MerchantCode) return !0; return !1 }(), viewModel.setErrorNumber = function () { viewModel.errorNumber(viewModel.ErrorNumber) }, viewModel.setErrorDescription = function () { viewModel.errorDescription(viewModel.ErrorDescription) } } function a(e) { this.Name = e.Name, this.ID = e.Id, this.Flag = e.Id.toLowerCase() } function r() { expressApp.printContentLoaded = !1; var e = l(), n = JSON.stringify(e), o = ""; return $.ajax({ url: expressCommon.urls.GetPaymentInformationHtml, async: !0, type: "POST", data: "{'paymentInformationData':'" + n + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { }, success: function (n) { o = n; var t = $("#print_area"); t.html(o.replace(/\{ExpressCdn\}/g, viewModel.ExpressCdn)), t.data("bank-id", e.BankID), viewModel.SelectedBankId == e.BankID && expressApp.printButtonPressed && expressApp.print() } }), !0 } function l() { var e, n = ""; return null != viewModelDynamicContent.ShopperInformation && (n = null != viewModelDynamicContent.ShopperInformation.FirstName && void 0 != viewModelDynamicContent.ShopperInformation.FirstName ? " " + viewModelDynamicContent.ShopperInformation.FirstName : "", n += null != viewModelDynamicContent.ShopperInformation.LastName && void 0 != viewModelDynamicContent.ShopperInformation.LastName ? " " + viewModelDynamicContent.ShopperInformation.LastName : ""), { ShopperAmountHasFees: viewModelDynamicContent.ShopperAmountHasFees(), ShopperEmail: escape($("input[name='ipt_email']").val()), ShopperName: n, TransactionID: viewModelDynamicContent.TransactionId.Value.Text, MerchantCode: viewModel.MerchantCode, ShopperAmount: viewModelDynamicContent.shopperAmount(), TotalShopperFees: viewModelDynamicContent.totalShopperFeesWithFormat().replace("(*)", ""), TotalAmount: viewModelDynamicContent.totalToPay(), PayableAmounts: (e = "", viewModelDynamicContent.Currencies.length > 0 && $.each(viewModelDynamicContent.Currencies, function (n, o) { e += o.Simbol + " " + o.Amount + " o " }), e.slice(0, -3)), ExpirationTime: viewModelDynamicContent.TransactionExpirationTime.Label.Text + " " + viewModelDynamicContent.TransactionExpirationTime.Value.Text, Language: viewModel.LanguageDefault, BankInstructions: function () { var e = []; return void 0 !== viewModelDynamicContent.Country.Banks && viewModelDynamicContent.Country.Banks.length > 0 && $.each(viewModelDynamicContent.Country.Banks, function () { var n = $(this)[0]; e.push({ Name: n.Name, Value: n.WorkingHours, Step: 0 }) }), e }.call(this), ShowExpirationTime: viewModel.ShowExpirationTime, OrderNumber: viewModel.OrderNumber.Value.Text, ChannelID: viewModel.SelectedChannelId, IsCashPayment: expressApp.isCashPayment, BarCode: "http://generator.barcodetools.com/barcode.png?gen=0&data=" + viewModelDynamicContent.TransactionId.Value.Text + "&bcolor=FFFFFF&fcolor=477DC1&tcolor=000000&fh=14&bred=0&w2n=2.5&xdim=2&w=&h=120&debug=1&btype=7&angle=0&quiet=1&balign=2&talign=0&guarg=1&text=0&tdown=1&stst=1&schk=0&cchk=1&ntxt=1&c128=0", CountryID: viewModelDynamicContent.Country.CountryId, MerchantName: null != viewModel.MerchantName.Value.Text && void 0 != viewModel.MerchantName.Value.Text ? viewModel.MerchantName.Value.Text : "", MerchantBranding: null != viewModel.MerchantBranding && void 0 != viewModel.MerchantBranding ? viewModel.MerchantBranding : "NoImage.jpg", ProductID: viewModel.ProductID, BankID: viewModel.SelectedBankId, ExpirationDate: c(viewModelDynamicContent.TransactionLocalExpirationDateTime, 1), CurrencyName: viewModelDynamicContent.currencyName(), BankName: viewModelDynamicContent.bankName(), ExpressVersion: "v4", LegalType: d(), IsAllowPaymentMethod: viewModel.IsAllowPaymentMethod, MerchantCss: viewModel.MerchantCss ? encodeURIComponent(viewModel.MerchantCss.replace(/'/g, '"')) : "", PaymentChannelCode: viewModel.SelectedBankPaymentChannelCode, SupportEmailMessageText: viewModel.SupportEmailMessageText } } function d() { var e = $("div.tabs_internos a.is-active").attr("data-legal-type"); return void 0 === e ? 1 : e } function c(e, n) { var o = ["", "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Setiembre", "Octubre", "Noviembre", "Diciembre"], t = e.split("T"), i = t[0].split("-"), a = t[1].split(":"), r = parseInt(a[0]), l = "a.m."; if (0 === r ? r = 12 : r > 12 ? (r %= 12, l = "p.m.") : 12 === r && (l = "p.m."), "2" == n) var d = i[2] + " " + o[parseInt(i[1])].toLowerCase() + " a las " + (r < 10 ? "0" : "") + r + ":" + (parseInt(a[1]) < 10 ? "0" : "") + parseInt(a[1]) + " " + l; else if ("3" == n) d = i[2] + " " + o[parseInt(i[1])].toLowerCase() + " - " + (r < 10 ? "0" : "") + r + ":" + (parseInt(a[1]) < 10 ? "0" : "") + parseInt(a[1]) + " " + l; else d = i[2] + " " + o[parseInt(i[1])].toLowerCase().substring(0, 3) + " - " + (r < 10 ? "0" : "") + r + ":" + (parseInt(a[1]) < 10 ? "0" : "") + parseInt(a[1]) + " " + l; return d } function s() { if (0 == $("input[name='ipt_celular']").length) return !1; if (0 == $("input[name='ipt_celular']").val().length) return !1; var e = { PhoneNumber: viewModel.CountryCode + $("input[name='ipt_celular']").val(), MerchantName: viewModel.MerchantName.Value.Text, BankName: viewModelDynamicContent.bankName(), ProductID: viewModel.ProductID, ChannelID: viewModel.SelectedChannelId, CountryID: viewModelDynamicContent.Country.CountryId, BankID: viewModel.SelectedBankId, TransactionID: viewModelDynamicContent.TransactionId.Value.Text, Amount: viewModelDynamicContent.totalToPay(), ExpirationTime: c(viewModelDynamicContent.TransactionLocalExpirationDateTime, 2), ExpressVersion: "v4", IsAllowPaymentMethod: viewModel.IsAllowPaymentMethod, PaymentChannelCode: viewModel.SelectedBankPaymentChannelCode }, n = JSON.stringify(e), o = !1; return $.ajax({ url: expressCommon.urls.SendPaymentInformationSMS, async: !1, type: "POST", data: "{'paymentInformationData':'" + n + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { resultSendSMS(!1) }, success: function (e) { o = e, $("input[name=ipt_celular]").removeAttr("placeholder") } }), o } function u(e) { var n, o, t, i, a, r, l = $.grep(viewModelDynamicContent.Currencies, function (n) { return n.CurrencyId === e }); if (l.length > 0) { var d = l[0]; viewModel.SelectedCurrencyId = e, viewModelDynamicContent.currencySymbol(d.Simbol), viewModelDynamicContent.totalToPay(function (e) { e = e.replace(/,/g, ""); var n = parseFloat(e); return viewModelDynamicContent.currencySymbol() + " " + n.format(2, 3, ",", ".") }(d.Amount)), viewModelDynamicContent.totalShopperFees(function (e) { for (var n = 0, o = 0; o < e.length; o++) n += parseFloat(e[o].PaymentConceptAmount); return parseFloat(n).toFixed(2) }(d.PaymentConcepts)), viewModelDynamicContent.totalShopperFeesWithFormat((a = viewModelDynamicContent.totalShopperFees(), r = parseFloat(a), viewModelDynamicContent.currencySymbol() + " " + r.format(2, 3, ",", "."))), viewModelDynamicContent.shopperAmount((n = d, o = viewModelDynamicContent.totalShopperFees(), t = n.Amount.replace(/,/g, ""), i = parseFloat(t) - o, viewModelDynamicContent.currencySymbol() + " " + i.format(2, 3, ",", "."))), viewModelDynamicContent.paymentConceptAmountQuoteId(d.PaymentConceptAmountQuoteId), viewModelDynamicContent.forexQuoteId(d.ForexQuoteId), viewModelDynamicContent.currencyName(d.Name), viewModelDynamicContent.ShopperAmountHasFees(p()) } } function m() { var e, n = $.grep(viewModelDynamicContent.Country.Banks, function (e) { return e.BankId === viewModel.SelectedBankId }); n.length > 0 && (e = n[0].Name); return e } function p() { var e = $.grep(viewModelDynamicContent.Currencies, function (e) { return e.CurrencyId === viewModel.SelectedCurrencyId }); return !(!e || !e[0]) && e[0].ShowConvenienceFee } function v(e, n, o) { for (var t, i = 0; i < e.length; i++) e[i].BankId === n && e[i].Type === viewModel.SelectedChannelId && e[i].LegalType == o && (t = e[i].WorkingHours); return t } function w(e, n, o, t, i) { var a = this; a.Name = e, a.ID = n, a.WorkingHours = o, a.ShowWorkingHours = viewModelDynamicContent.ShowWorkingHours, a.LegalType = t, a.paymentChannelCode = i } function y(e, n) { this.id = e, this.items = ko.observableArray(n) } function C(e) { this.Message = e.Message, this.Step = e.Step } function M(e) { var n = [], o = $.grep(viewModelDynamicContent.BankList, function (n) { return n.LegalType == e }); if (4 == e) { for (var t = [], i = 0; i < agentesSortOrder.length; i++) for (var a = 0; a < o.length; a++) o[a].PaymentChannelCode == agentesSortOrder[i] && t.push(o[a]); o = t } for (var r = 0; o.length > 0;) { var l = [], d = o.splice(0, 4); for (i = 0; i < d.length; i++) { var c = v(o, d[i].Id, e); l.push(new w(d[i].Name, d[i].Id, c, d[i].LegalType, d[i].PaymentChannelCode)) } n.push(new y(r, l)), r++ } return n } function h(e) { var n = this; n.CurrencyId = e.CurrencyId, n.Name = e.Name, n.Simbol = e.Simbol, n.AmountWithSymbol = e.Simbol + " " + e.Amount, n.ForexQuoteId = e.ForexQuoteId, n.Amount = e.Amount, n.PaymentConceptAmountQuoteId = e.PaymentConceptAmountQuoteId } function f() { var e = [], n = viewModelDynamicContent.Country.Banks, o = $.grep(n, function (e) { return e.BankId === viewModel.SelectedBankId && e.LegalType == d() }); if (o.length > 0) { for (var t = o[0].OnlineBankInstructions, i = Math.ceil(t.length / 2), a = [], r = 0; r < i; r++) { var l = t[r]; a.push(new C(l)) } for (e.push(new y(0, a)), a = [], r = i; r < t.length; r++) { l = t[r]; a.push(new C(l)) } e.push(new y(1, a)) } return e } function D() { var e, n = viewModelDynamicContent.Country.Banks, o = $("a.link.seleccionado").data("paymentCode"); if ((e = o ? $.grep(n, function (e) { return e.BankId === viewModel.SelectedBankId && e.PaymentChannelCode == o }) : $.grep(n, function (e) { return e.BankId === viewModel.SelectedBankId })).length > 0) { var t = e[0].CashBankInstructions; if (null !== t && t.length > 0) { var i = t[0].Message; viewModelDynamicContent.bankInstructionTop(i), $("#bank_instruction_top").length > 0 && (ko.cleanNode(document.getElementById("bank_instruction_top")), ko.applyBindings(viewModelDynamicContent, document.getElementById("bank_instruction_top"))), t.length > 1 ? (i = t[1].Message, viewModelDynamicContent.bankInstructionBottom(i), $("#bank_instruction_bottom").length > 0 && (ko.cleanNode(document.getElementById("bank_instruction_bottom")), ko.applyBindings(viewModelDynamicContent, document.getElementById("bank_instruction_bottom")))) : viewModelDynamicContent.bankInstructionBottom("") } else viewModelDynamicContent.bankInstructionTop(""), viewModelDynamicContent.bankInstructionBottom("") } else viewModelDynamicContent.bankInstructionTop(""), viewModelDynamicContent.bankInstructionBottom("") } function g() { var e = viewModelDynamicContent.Country.Banks, n = $.grep(e, function (e) { return e.BankId === viewModel.SelectedBankId && e.LegalType == d() }); if (n.length > 0) { var o = n[0].OnlineBankInstructions; if (null !== o && o.length > 0) for (var t = 0; t < o.length; t++) { o[0].Message; var i = "step_" + (t + 1); if ($("#" + i).length > 0) try { ko.applyBindings(viewModelDynamicContent, document.getElementById(i)) } catch (e) { } } } } function k(e) { var n; n = s, setTimeout(function () { n() }, 0), function () { var e = viewModel.SelectedCountryId, n = viewModelDynamicContent.selectedCurrency(), o = viewModel.SelectedBankId; $.cookie("CkCountry", e, { expires: 7 }), $.cookie("CkCurrency", n, { expires: 7 }), $.cookie("CkBank", o, { expires: 7 }) }.call(this); for (var o = {}, t = 0; t < viewModelDynamicContent.Currencies.length; t++) o[viewModelDynamicContent.Currencies[t].CurrencyId] = viewModelDynamicContent.Currencies[t].PaymentConceptAmountQuoteId; var i = { step: e, tokenId: viewModel.TokenId, merchantId: viewModel.MerchantCode, countryId: viewModel.SelectedCountryId, shopperCurrencyId: viewModelDynamicContent.selectedCurrency(), ChannelIdForFilter: viewModel.ChannelIdForFilter, shopperBankId: viewModel.SelectedBankId, forexQuoteId: viewModelDynamicContent.forexQuoteId(), language: viewModel.LanguageDefault, dataJson: o, PaymentOption: viewModel.SelectedChannelId, PaymentConceptAmountQuoteId: viewModelDynamicContent.paymentConceptAmountQuoteId() }, a = JSON.stringify(i); $.ajax({ url: expressCommon.urls.GetRenderProviderContent, type: "POST", data: "{'data':'" + a + "'}", dataType: "json", contentType: "application/json; charset=utf-8", async: !1, error: function () { }, success: I }) } function I(e) { var n = JSON.parse(e.ViewModel); if ("null" != typeof n) if (0 === e.ErrorNumber || 1004 === e.ErrorNumber) expressApp.navigationUrl = n.NavigationUrl, expressCommon.callGoogleAnalytics("Payment", "Checkout", ", CountryId=" + viewModel.SelectedCountryId + ", BankId=" + viewModel.SelectedBankId + ", CurrencyId=" + viewModel.SelectedCurrencyId + ", ChannelId=" + viewModel.SelectedChannelId), 1 === viewModel.ProductID && (window.viewModel.ShowBanksInNewWindows || viewModelDynamicContent.ShowWaitingState ? "Safari" == expressCommon.getBrowserName() ? expressCommon.openNewWindowInSafari(n.NavigationUrl) : popupBank.location = n.NavigationUrl : window.location = n.NavigationUrl); else { 1 === viewModel.ProductID && "Safari" != expressCommon.getBrowserName() && (window.viewModel.ShowBanksInNewWindows || viewModelDynamicContent.ShowWaitingState) && popupBank.close(); var o = expressCommon.getErrorMessage(e.ErrorNumber); "" === o && (o = e.ErrorDescription), viewModel.ErrorNumber = e.ErrorNumber, viewModel.ErrorDescription = o, 2003 === viewModel.ErrorNumber || 2002 === viewModel.ErrorNumber || 2005 === viewModel.ErrorNumber || 2006 === viewModel.ErrorNumber ? setTimeout(function () { expressWaitingState.finalize(), location.reload() }, 0) : expressCommon.showErrorPage() } else viewModel.ErrorNumber = 2e3, viewModel.ErrorDescription = "Error", expressCommon.showErrorPage() } function b() { var e; if (viewModelDynamicContent.Country.Banks.length && (e = viewModelDynamicContent.Country.Banks[0], viewModel.SelectedBankId || viewModelDynamicContent.DefaultBankId)) { for (var n = viewModelDynamicContent.Country.Banks[0], o = 0; o < viewModelDynamicContent.Country.Banks.length; o++) viewModel.SelectedBankPaymentChannelCode ? viewModel.SelectedBankPaymentChannelCode == viewModelDynamicContent.Country.Banks[o].PaymentChannelCode && (n = viewModelDynamicContent.Country.Banks[o]) : (viewModel.SelectedBankId || viewModelDynamicContent.DefaultBankId) == viewModelDynamicContent.Country.Banks[o].BankId && viewModelDynamicContent.Country.Banks[o].LegalType == d() && (n = viewModelDynamicContent.Country.Banks[o]); n && (e = n) } return e } this.ExpressApp = function () { this.isCashPayment = !1, this.navigationUrl = "" }, ExpressApp.prototype.init = function () { try { 0 === viewModel.ErrorNumber ? (2 === viewModel.ProductID && (this.isCashPayment = !0), i.call(this), ko.applyBindings(viewModel, document.getElementById("expressHeader")), 1 != d() ? viewModelDynamicContent.ShowPersonasSection = ko.observable(!1) : viewModelDynamicContent.ShowPersonasSection = ko.observable(!0), viewModelDynamicContent.IsValidAmountLimit = ko.observable(!1), viewModelDynamicContent.MaxLimitValue = ko.observable(0), viewModelDynamicContent.WorkingStatus = ko.observable(2), viewModelDynamicContent.SelectedBankPaymentChannelCode = ko.observable(), n = $("div.pasos_wrapper"), viewModel.MainContent = n.html(), bank = b(), viewModelDynamicContent.SelectedBankPaymentChannelCode(bank.PaymentChannelCode), bank && 1 != viewModel.ProductID && (viewModel.SelectedBankPaymentChannelCode = bank.PaymentChannelCode, e(2, bank.PaymentChannelCode)), function () { popupName = "popupBank_" + expressCommon.getCustomDate(), viewModelDynamicContent.availableBanks = ko.observableArray(M(1)), viewModelDynamicContent.availableCurrencies = ko.observableArray(function (e) { var n = []; if (null === e) return n; for (var o = 0; o < e.length; o++) n.push(new h(e[o])); return n }(viewModelDynamicContent.Currencies)), viewModelDynamicContent.bankInstructions = ko.observableArray(1 === viewModel.ProductID ? f() : []), viewModelDynamicContent.bankName = ko.observable(m()), viewModelDynamicContent.totalToPay = ko.observable(""), viewModelDynamicContent.totalShopperFees = ko.observable(""), viewModelDynamicContent.totalShopperFeesWithFormat = ko.observable(""), viewModelDynamicContent.shopperAmount = ko.observable(""), viewModelDynamicContent.currencySymbol = ko.observable(""), viewModelDynamicContent.forexQuoteId = ko.observable(""), viewModelDynamicContent.currencyName = ko.observable(""), viewModelDynamicContent.paymentConceptAmountQuoteId = ko.observable(""), viewModelDynamicContent.ShopperAmountHasFees = ko.observable(p()), viewModelDynamicContent.requestPhone = !1, viewModelDynamicContent.mobile = ko.observable(null === viewModelDynamicContent.ShopperInformation ? "" : viewModelDynamicContent.ShopperInformation.Mobile), viewModelDynamicContent.expirationDateTime = c(viewModelDynamicContent.TransactionLocalExpirationDateTime, 1), viewModelDynamicContent.expirationDateTimeFormat3 = c(viewModelDynamicContent.TransactionLocalExpirationDateTime, 3), viewModelDynamicContent.selectedCurrency = ko.observable(viewModel.SelectedCurrencyId), viewModelDynamicContent.HasAgencies = ko.observable(function () { if (2 === viewModel.ProductID) { var e = $.grep(viewModelDynamicContent.BankList, function (e) { return 1 == e.LegalType }); return e.length !== viewModelDynamicContent.BankList.length } return !1 }()), viewModelDynamicContent.selectedCurrency.subscribe(function () { u(viewModelDynamicContent.selectedCurrency()), 2 === viewModel.ProductID && k(1) }, this), u(viewModel.SelectedCurrencyId), 2 === viewModel.ProductID && (viewModelDynamicContent.bankInstructionTop = ko.observable(""), viewModelDynamicContent.bankInstructionBottom = ko.observable("")); viewModelDynamicContent.fillBankInstructions = function () { viewModelDynamicContent.bankInstructions(f()), g() }, viewModelDynamicContent.setBankName = function () { viewModelDynamicContent.bankName(m()) }, viewModelDynamicContent.ShowWaitingState && expressWaitingState.init(); viewModelDynamicContent.MerchantName = viewModel.MerchantName.Value.Text, viewModelDynamicContent.MerchantCode = viewModel.MerchantCode, viewModelDynamicContent.IsMaryKayPeru = "6010" === viewModel.MerchantCode, ko.applyBindings(viewModelDynamicContent, document.getElementById("DynamicRenderContent")), contador_tiempo("timer_hor_1", "timer_min_1", "timer_seg_1"), viewModel.CountryCode = "+51", 1 === viewModel.ProductID ? expressCommon.setCashPaymentUrl("tabCash") : (viewModelDynamicContent.fillCashBankInstructions = function () { D() }, expressCommon.setOnlinePaymentUrl("tabOnline")); viewModelDynamicContent.IsValidAmountLimit = ko.observable(!1), viewModelDynamicContent.MaxLimitValue = ko.observable(0), viewModelDynamicContent.FinalizeError = ko.observable(!1), viewModelDynamicContent.FinalizeLabelInvalidError = ko.observable(!1), viewModelDynamicContent.FinalizeLabelValidError = ko.observable(!1), viewModelDynamicContent.FinalizeButtonLinkDirected = !1 }(), r(), viewModel.IsVoucher || function () { var e = !1; if (null !== $.cookie("CkCountry")) { var n = $.cookie("CkCountry"); if (n === viewModel.CountryDefaultId && void 0 != viewModelDynamicContent.CountryList && viewModelDynamicContent.CountryList.length > 0) { var o = $.grep(viewModelDynamicContent.CountryList, function (e) { return e.Id === n }); o.length > 0 && (e = !0) } } if (!e) return setTimeout(function () { $("#" + viewModel.SelectedBankId).click() }, 0), void $("#" + viewModel.SelectedBankId).click(); if (null !== $.cookie("CkBank")) { var i = $.cookie("CkBank"); if (viewModelDynamicContent.Country.Banks.length > 0) { var a = $.grep(viewModelDynamicContent.Country.Banks, function (e) { return e.BankId === i }); a.length > 0 && setTimeout(t, 300) } } }.call(this), viewModel.ShowSupportChat && function () { merchantName = viewModel.MerchantName.Value.Text, orderNumber = viewModel.OrderNumber.Value.Text, purchaseAmount = viewModel.PurchaseAmountCurrency.Value.Text + " " + viewModel.PurchaseAmount.Value.Text; var e = document.createElement("script"); e.type = "text/javascript", e.async = !0, void 0 != viewModel.WidgetSource && "" !== viewModel.WidgetSource && "" !== viewModel.WidgetSource ? e.src = viewModel.WidgetSource : e.src = "//commondatastorage.googleapis.com/code.snapengage.com/js/613c7ed4-7771-4c05-ab32-50d617a4e946.js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(e, n) }.call(this)) : (i.call(this), ko.applyBindings(viewModel)), expressCommon.saveVisitor(), viewModelDynamicContent.ShowFinalizeButton && "2" === viewModelDynamicContent.DefaultChannelId && ($("#tabOnline").click(function (e) { e.preventDefault(), expressWaitingState.finalize(), window.location.href = $(this).attr("href") }), expressWaitingState.avoidCloseBrowser("Si cierras esta ventana tu transacción no será finalizada. Por favor da click en el botón finalizar antes de cerrar esta ventana. ¿Estás seguro que quieres dejar la página?")) } catch (e) { console.log(e) } var n }, ExpressApp.prototype.getTransactionDetail = function (e) { k(e) }, ExpressApp.prototype.goToPayWaitingForState = function () { !function () { if (1 === viewModelDynamicContent.step()) return void ("Safari" == expressCommon.getBrowserName() ? expressCommon.openNewWindowInSafari(expressApp.navigationUrl) : popupBank.location = expressApp.navigationUrl); $("a.boton_azul").html('<i class="iconb_circleright"></i>Reintentar'), $("div.WaitingState").show(), viewModelDynamicContent.setStep(1), function () { $("#countries").ddslick("disabled"), $("#moneda").ddslick("disabled"), $("div.terminos input").prop("disabled", "disabled"); var e = $("div.link-wrapper a.link"); $.each(e, function () { $(this).addClass("disabled") }), void 0 != $("#tabCash") && $("#tabCash").click(function (e) { e.preventDefault() }) }(), k(1), expressWaitingState.avoidCloseBrowser("Si cierras esta ventana tu transacción no será finalizada. Por favor permanezca en esta página para que podamos finalizar la correctamente..."), expressWaitingState.startNotification() }() }, ExpressApp.prototype.saveShopperDetail = function () { setTimeout(function () { (function () { var e = 0; null != viewModelDynamicContent.ShopperInformation && (e = viewModelDynamicContent.ShopperInformation.ShopperId); var n = viewModel.TokenId, o = { country_code: viewModel.CountryCode, mobile: $("input[name='ipt_celular_codigo_pago']").val() }; $.ajax({ url: expressCommon.urls.SaveShopperDetail, type: "POST", data: "{'tokenId':'" + n + "','shopperId':'" + e + "', 'data':'" + JSON.stringify(o) + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { }, success: function () { } }) }).call(this) }, 0) }, ExpressApp.prototype.sendPaymentInformationSMS = function () { return s() }, ExpressApp.prototype.sendPaymentInformationEmail = function () { return e = l(), n = JSON.stringify(e), o = !1, $.ajax({ url: expressCommon.urls.SendPaymentInformationEmail, async: !1, type: "POST", data: "{'paymentInformationData':'" + n + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { }, success: function (e) { o = e } }), o; var e, n, o }, ExpressApp.prototype.getPaymentInformationHtml = function () { r() }, ExpressApp.prototype.hasBanks = function (e) { return !!$.grep(viewModelDynamicContent.BankList, function (n) { return n.LegalType == e }).length }, ExpressApp.prototype.print = function () { if (!expressApp.printGoing) { var e = $("#print_area"); e.ready(function () { expressApp.printGoing = !0, e.imagesLoaded().always(function (e) { fontSpy("Open Sans", { success: function () { window.print(), expressApp.printGoing = !1, expressApp.printButtonPressed = !1 }, failure: function () { setTimeout(function () { window.print(), expressApp.printGoing = !1, expressApp.printButtonPressed = !1 }, 1e3) } }) }) }) } }, ExpressApp.prototype.setShopperAmount = function (e) { u(e) }, ExpressApp.prototype.populateArrayBanks = function (e) { return M(e) }, ExpressApp.prototype.showErrorPage = function (e, n) { return function (e, n) { try { if (-1 === viewModel.ErrorNumber) return viewModel.setErrorNumber(), void viewModel.setErrorDescription(); if (1003 == viewModel.ErrorNumber || 1004 == viewModel.ErrorNumber || 10212 == viewModel.ErrorNumber || 10213 == viewModel.ErrorNumber || 2002 == viewModel.ErrorNumber || 2003 == viewModel.ErrorNumber || 2005 == viewModel.ErrorNumber || 2006 == viewModel.ErrorNumber) return expressWaitingState.finalize(), void location.reload(); var o = { merchantCode: viewModel.MerchantCode, countryId: viewModel.CountryDefaultId, language: viewModel.LanguageDefault, errorCode: viewModel.ErrorNumber, bankId: e.toString(), renderFullPage: !n }, t = JSON.stringify(o); $.ajax({ url: expressCommon.urls.GetHtmlContentError, async: !1, type: "POST", data: "{'data':'" + t + "'}", dataType: "json", contentType: "application/json; charset=utf-8", error: function () { viewModel.setErrorNumber(), viewModel.setErrorDescription() }, success: function (o) { if ("" === o) viewModel.setErrorNumber(), viewModel.setErrorDescription(), viewModelDynamicContent.ShowWaitingState && expressWaitingState.finalize(); else { var t; if (n) { for (var i = viewModelDynamicContent.Country.Banks[0], a = 0; a < viewModelDynamicContent.Country.Banks.length; a++) e == viewModelDynamicContent.Country.Banks[a].BankId && (i = viewModelDynamicContent.Country.Banks[a]); t = 3 == i.LegalType ? "#StoresDynamicRenderContent" : "#DynamicRenderContent" } else t = "body"; var r = $(t), l = viewModel; if (n) { r.empty(); var d = $("<iframe>", { scrolling: "no", class: "errorContentFrame" }); d.load(function () { $(d).contents().find("body"); $(d.get(0).contentWindow).ready(resizeIframe(d.get(0))) }), $(window).off("resize").resize(function () { resizeIframe(d.get(0)) }); var c = d.appendTo(t).contents(); c[0].open(), c[0].write(o), c[0].close(), r = d } else r.html(o); viewModel = l, viewModel.errorNumber = ko.observable(viewModel.ErrorNumber), viewModel.ErrorDescription && (viewModel.errorDescription = viewModel.ErrorDescription.replace("[MerchantName]", viewModel.MerchantName.Value.Text)), r.on("load", function () { var e = r.is("iframe") ? r.contents().find("body").get(0) : r.get(0); ko.cleanNode(e), viewModelDynamicContent.ShowWaitingState && expressWaitingState.finalize(), ko.applyBindings(viewModel, e) }), n && (viewModel.ErrorNumber = 0) } } }) } catch (e) { console.log(e) } }(e, n) }, ExpressApp.prototype.disableBank = function () { $("div.terminos input").prop("disabled", !0), $("a.boton_azul").addClass("disabled"), $(".cicn, .BoxIcon").addClass("disabled"), $(".icona_print").parent().parent().addClass("disabled"), $("input.ipt_instr_email, input.ipt_instr_celular").prop("disabled", !0), $(".BotonPrincipal:not(.ReturnToMerchant)").addClass("disabled").prop("disabled", !0) }, ExpressApp.prototype.customApplyBindingBank = function () { var e = $("div.pasos_wrapper").get(0); ko.cleanNode(e), ko.applyBindings(viewModelDynamicContent, e) }, ExpressApp.prototype.GetRenderProviderContent = function (n, o) { e(n, o) } }(); var expressApp = new ExpressApp; $(document).ready(function () { (expressApp.init(), "4511" === viewModel.MerchantCode && "PER" === viewModel.SelectedCountryId || "4686" === viewModel.MerchantCode && "PER" === viewModel.SelectedCountryId || "5910" === viewModel.MerchantCode && "PER" === viewModel.SelectedCountryId) && ($.grep(viewModelDynamicContent.Currencies, function (e) { return "USD" === e.CurrencyId }).length > 0 && viewModelDynamicContent.selectedCurrency("USD")) });

//seleccion-financiera_per.js
var seleccionFinanciera=function(){"use strict";var e={};e.init=function(){i(2===viewModel.ProductID?".SeleccionFinanciera--pagoEfectivo":".SeleccionFinanciera--bancaInternet")},e.refreshAllSlides=function(){$(".SeleccionFinanciera-slide").slick("setPosition")};var i=function(e){var i=$(e).find(".SeleccionFinanciera-slideWrapper"),n=$(e).find(".SeleccionFinanciera-slide"),s=$(e).find(".SeleccionFinanciera-slideButtons");n.slick({infinite:!1,slidesToShow:1,slidesToScroll:1,appendArrows:s,prevArrow:'<div class="slideButton slideButton--prev"><i class="fa fa-chevron-left"></i></div>',nextArrow:'<div class="slideButton slideButton--next"><i class="fa fa-chevron-right"></i></div>',speed:250,cssEase:"linear",focusOnSelect:!1,reponsive:!1}),n.on("afterChange",function(e,n,s){var a=n.$prevArrow,c=n.$nextArrow;a.hasClass("slick-disabled")?i.removeClass("espacio_left"):i.addClass("espacio_left"),c.hasClass("slick-disabled")?i.addClass("no_espacio_right"):i.removeClass("no_espacio_right")})};return e}();$(function(){"use strict";seleccionFinanciera.init()});

//scripts_per-4.25.5.0.js
function finalize(e,i){i=i||window.event,i.preventDefault(),$(e).hasClass("finalize-ok")||viewModelDynamicContent.FinalizeButtonLinkDirected?(viewModelDynamicContent.FinalizeButtonLinkDirected=!0,expressWaitingState.finalize(),window.open(viewModelDynamicContent.FinalizeButtonLink,{target:"_blank"})):($("#frm_instr_celular").valid()?(viewModelDynamicContent.FinalizeLabelValidError(!0),viewModelDynamicContent.FinalizeLabelInvalidError(!1)):""==$(".InputText--celularLarge").val()&&(viewModelDynamicContent.FinalizeLabelInvalidError(!0),viewModelDynamicContent.FinalizeLabelValidError(!1)),viewModelDynamicContent.FinalizeError(!0))}$(document).ready(function(){function e(){var e=2===viewModel.ProductID?"instrucciones.pago_efectivo":"botones_instrucciones";$("div."+e).find("div.inoculto").addClass("disabled"),$("div."+e).find(":input").prop("disabled",!0),$("div."+e).find(":input").addClass("disabled"),$(".finalize").addClass("disabled").attr("disabled","disabled"),1===viewModel.ProductID?$("div."+e).find("a.boton_azul").addClass("disabled"):($(".BotonPrincipal:not(.ReturnToMerchant)").addClass("disabled").prop("disabled",!0),$(".BoxInputVisible").find(":input").prop("disabled",!0))}function i(){var e=2===viewModel.ProductID?"instrucciones.pago_efectivo":"botones_instrucciones";$("div."+e).find("div.inoculto").removeClass("disabled"),$("div."+e).find(":input").prop("disabled",!1),$("div."+e).find(":input").removeClass("disabled"),$(".finalize").removeClass("disabled").removeAttr("disabled"),1===viewModel.ProductID?$("div."+e).find("a.boton_azul").removeClass("disabled"):($(".BotonPrincipal:not(.ReturnToMerchant)").removeClass("disabled").prop("disabled",!1),$(".BoxInputVisible").find(":input").prop("disabled",!1))}function n(){$(".finalize").addClass("finalize-ok"),viewModelDynamicContent.FinalizeError(!1),viewModelDynamicContent.FinalizeLabelInvalidError(!1),viewModelDynamicContent.FinalizeLabelValidError(!1)}function a(){var e=$("#frm_instr_celular").validate(),i=$("#frm_instr_email").validate();e&&e.resetForm(),i&&i.resetForm()}function t(){$('div.terminos :input[type="checkbox"]').click(function(n){this.checked?i():e()}),$("a.boton_azul").click(function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;"Safari"!=expressCommon.getBrowserName()&&(popupBank=window.open("about:blank",popupName)),viewModelDynamicContent.ShowWaitingState?expressApp.goToPayWaitingForState():expressApp.getTransactionDetail(1)}),l.icon_print=$(".icona_print"),l.icon_print.click(function(){return!$(this).parent().parent().hasClass("disabled")&&(expressApp.printButtonPressed=!0,viewModel.SelectedBankId==$("#print_area").data("bank-id")&&(n(),a(),expressApp.print()),!1)}),d("form_codigo_pago"),c("frm_instr_celular","frm_instr_email"),o()}var l={},o=function(){$("#countries").ddslick({width:97,onSelected:function(e){""!=e.selectedData.value&&viewModel.selectedCountry!==e.selectedData.value&&(viewModelDynamicContent.ShowFinalizeButton&&2===viewModel.ProductID&&expressWaitingState.finalize(),expressCommon.redirect(e.selectedData.value))}}),$("#tel_number").ddslick({height:150,width:95}),$("#moneda").ddslick({width:93,onSelected:function(e){""!=e.selectedData.value&&viewModelDynamicContent.selectedCurrency()!==e.selectedData.value&&(viewModelDynamicContent.selectedCurrency(e.selectedData.value),expressApp.getPaymentInformationHtml())}}),$("#tel_number_efvo").ddslick({height:150,width:95}),$(".dd-container").click(function(){$(this).find(".dd-pointer").hasClass("dd-pointer-up")?$(this).find(".dd-options").css({overflow:"auto"}):$(this).find(".dd-options").css({overflow:"hidden"})})};$(".tab-content").fadeIn(),seleccionFinanciera.refreshAllSlides();var r=function(){l.banco_button=$(".SeleccionFinanciera-slide a.link"),l.banco_button.on("click",function(e){e.preventDefault();var i=$(this);if(!$(i).hasClass("seleccionado")&&!$(i).hasClass("disabled")){$("#timer_hor_1").length?external.savedTime=[$("#timer_hor_1").text(),$("#timer_min_1").text(),$("#timer_seg_1").text()-1,new Date]:external.savedTime=[],i.parents(".SeleccionFinanciera-slide").find("a.link").removeClass("seleccionado"),i.addClass("seleccionado");try{viewModelDynamicContent.FinalizeError(!1),viewModelDynamicContent.FinalizeLabelInvalidError(!1),viewModelDynamicContent.FinalizeLabelValidError(!1);var n=viewModel.SelectedBankId,a=viewModel.SelectedBankPaymentChannelCode;viewModel.SelectedBankId=this.id,viewModel.SelectedBankPaymentChannelCode=$(this).data("paymentCode"),viewModelDynamicContent.SelectedBankPaymentChannelCode(viewModel.SelectedBankPaymentChannelCode);var t=$(".tabs_internos a.is-active").data("legalType");if(1!=t?viewModelDynamicContent.ShowPersonasSection(!1):viewModelDynamicContent.ShowPersonasSection(!0),viewModelDynamicContent.setBankName(),1!==viewModel.ProductID&&(expressApp.GetRenderProviderContent(2,viewModel.SelectedBankPaymentChannelCode),a!=viewModel.SelectedBankPaymentChannelCode)){var l,o=viewModelDynamicContent.Country.Banks[0];if(4==t){for(var r=0;r<viewModelDynamicContent.Country.Banks.length;r++)viewModel.SelectedBankPaymentCode==viewModelDynamicContent.Country.Banks[r].PaymentChannelCode&&(o=viewModelDynamicContent.Country.Banks[r]);l=$.makeArray(viewModelDynamicContent.Country.Banks).filter(function(e){return e.PaymentChannelCode==a})[0]}else{for(r=0;r<viewModelDynamicContent.Country.Banks.length;r++)viewModel.SelectedBankId==viewModelDynamicContent.Country.Banks[r].BankId&&(o=viewModelDynamicContent.Country.Banks[r]);l=$.makeArray(viewModelDynamicContent.Country.Banks).filter(function(e){return e.BankId==n})[0]}if(l&&l.Content||o.Content){var s="";o&&(s=o.Content?o.Content:viewModel.MainContent),external.htmlContent=s}}expressApp.getPaymentInformationHtml(),2===viewModel.ProductID?viewModelDynamicContent.fillCashBankInstructions():viewModelDynamicContent.fillBankInstructions()}catch(e){console.log(e)}}})},s=function(e){var i=$("#"+e);i.find(".ingresa").slideUp(300),i.find(".pasos_wrapper").slideDown(500),contador_tiempo("timer_hor_1","timer_min_1","timer_seg_1")},d=function(e){l.form_codigo_pago=$("#"+e),l.form_codigo_pago.find("input.celular").numeric(),l.form_codigo_pago.validate({onkeyup:function(e){$(e).valid()},submitHandler:function(e){s(1===viewModel.ProductID?"tab-1":"tab-2"),l.form_codigo_pago.find("input.celular").attr("disabled","disabled"),l.form_codigo_pago.find("input[type='submit']").attr("disabled","disabled");var i=l.form_codigo_pago.find("input.celular").val();viewModelDynamicContent.mobile(i),expressApp.saveShopperDetail()}}),l.form_codigo_pago.find(".celular").rules("add",{required:!0,digits:!0,minlength:9,maxlength:9,messages:{required:"Ingrese su teléfono.",digits:"Ingrese sólo números.",minlength:"Complete 9 dígitos.",maxlength:"Ingrese máximo 9 dígitos."}})},c=function(e,i){l.form_celular=$("#"+e),l.icon_celular=l.form_celular.find(".icona_celular"),l.form_email=$("#"+i),l.icon_email=l.form_email.find(".icona_mail"),l.form_celular.find("input.ipt_instr_celular").numeric({negative:!1}),l.form_celular.validate({onkeyup:function(e){$(e).valid(),viewModelDynamicContent.FinalizeLabelValidError(!1),viewModelDynamicContent.FinalizeLabelInvalidError(!1),$(e).valid()&&viewModelDynamicContent.FinalizeError()&&viewModelDynamicContent.FinalizeLabelValidError(!0)},submitHandler:function(e){$(e).find("input.ipt_instr_celular").attr("disabled","disabled"),expressApp.sendPaymentInformationSMS()&&($(".ipt_instr_celular").val(""),$(e).find("input.ipt_instr_celular").removeAttr("disabled"),$(e).parents(".EnvioInstrucciones-boxEnvioSms").length?(n(),a(),$(e).find(".BoxBotonSubmit").addClass("is-sent")):($(e).find(".icona_celular").removeClass("is-displayed"),$(e).find(".icona_celular").addClass("is-sent"),$(e).find(".icona_celular").parent().parent().children("input").hide(),$(e).find(".icona_celular").parent().parent().children("input").val("")))}}),l.form_celular.find(".ipt_instr_celular").rules("add",{required:!0,digits:!0,minlength:9,maxlength:9,messages:{required:"Ingrese su teléfono.",digits:"Ingrese sólo números.",minlength:"Complete 9 dígitos.",maxlength:"Ingrese máximo 9 dígitos."}}),l.icon_celular.click(function(){var e=$(this),i=e.parents(".frm_instr_celular").siblings(".frm_instr_email").find("input.ipt_instr_email"),n=e.parents(".frm_instr_celular").siblings(".frm_instr_email").find(".icona_mail");if(i.hasClass("error")){i.parents(".frm_instr_email").validate().resetForm()}if(e.parents(".frm_instr_celular").find("input.ipt_instr_celular").prop("disabled"))return!1;e.hasClass("is-sent")&&e.removeClass("is-sent"),e.hasClass("is-displayed")?e.parents(".frm_instr_celular").submit():(e.addClass("is-displayed"),e.parent().parent().children("input").show()),n.removeClass("is-displayed"),i.hide()}),l.form_email.validate({onkeyup:function(e){$(e).valid()},submitHandler:function(e){$(e).find("input.ipt_instr_email").attr("disabled","disabled"),expressApp.sendPaymentInformationEmail()&&(n(),a(),$(e).find("input.ipt_instr_email").removeAttr("disabled"),$(e).find(".icona_mail").removeClass("is-displayed"),$(e).find(".icona_mail").addClass("is-sent"),$(e).find(".icona_mail").parent().parent().children("input").hide(),$(e).find(".icona_mail").parent().parent().children("input").val(""))}}),$.validator.addMethod("regx",function(e,i,n){return n.test(e)},"Ingrese un valor válido."),l.form_email.find(".ipt_instr_email").rules("add",{required:!0,email:!0,regx:/^(?!\.)("([^"\r\\]|\\["\r\\])*"|(([-a-z0-9!#$%&'*+\/=?^_`{|}~]))(\.)?)*@[a-z0-9][\w\.-]*[a-z0-9]\.[a-z][a-z\.]*[a-z]$/i,messages:{required:"Ingrese su correo.",email:"Ingrese un correo válido.",regx:"Ingrese un correo válido."}}),l.icon_email.click(function(){var e=$(this),i=e.parents(".frm_instr_email").siblings(".frm_instr_celular").find("input.ipt_instr_celular"),n=e.parents(".frm_instr_email").siblings(".frm_instr_celular").find(".icona_celular");if(i.hasClass("error")){i.parents(".frm_instr_celular").validate().resetForm()}return!e.parents(".frm_instr_celular").find("input.ipt_instr_celular").prop("disabled")&&(!e.parents(".frm_instr_email").find("input.ipt_instr_email").prop("disabled")&&(e.hasClass("is-sent")&&e.removeClass("is-sent"),e.hasClass("is-displayed")?e.parents(".frm_instr_email").submit():(e.addClass("is-displayed"),e.parent().parent().children("input").show()),n.removeClass("is-displayed"),void i.hide()))})};l.icon_print=$(".icona_print"),l.icon_print.click(function(){return!$(this).parent().parent().hasClass("disabled")&&(expressApp.printButtonPressed=!0,viewModel.SelectedBankId==$("#print_area").data("bank-id")&&(n(),a(),expressApp.print()),!1)});$('div.terminos :input[type="checkbox"]').click(function(n){this.checked?i():e()}),$("a.boton_azul").click(function(e){if(e.preventDefault(),$(this).hasClass("disabled"))return!1;"Safari"!=expressCommon.getBrowserName()&&(window.viewModel.ShowBanksInNewWindows||viewModelDynamicContent.ShowWaitingState)&&(popupBank?popupBank.window?popupBank.focus():popupBank=window.open("about:blank","popupBank"+popupName):popupBank=window.open("about:blank",popupName)),viewModelDynamicContent.ShowWaitingState?expressApp.goToPayWaitingForState():expressApp.getTransactionDetail(1)});external.initBankContent=t,o(),d("form_codigo_pago"),c("frm_instr_celular","frm_instr_email"),r(),function(){var e=$("#frm_mensaje_texto_large"),i=e.find("input.ipt_celular_large");i.numeric({decimal:!1,negative:!1},function(){}),i.on("click",function(){$("#frm_instr_email").find(".ipt_instr_email").hasClass("error")&&$("#frm_instr_email").validate().resetForm();$(this).hasClass("is-sent")&&$(this).removeClass("is-sent")});var n=e.validate({onfocusout:function(){n.resetForm()},onkeyup:function(e){$(e).valid()},rules:{ipt_celular:{required:!0,digits:!0,minlength:9,maxlength:9}},messages:{ipt_celular:{required:"Ingrese su teléfono.",digits:"Ingrese sólo números.",minlength:"Complete 9 dígitos.",maxlength:"Ingrese máximo 9 dígitos."}},submitHandler:function(e){$(".btn_send_celular_large").attr("disabled","disabled"),$(".ipt_celular_large").attr("disabled","disabled");var i=expressApp.sendPaymentInformationSMS();$(".btn_send_celular_large").removeAttr("disabled"),$(".ipt_celular_large").removeAttr("disabled"),i&&$(".ipt_celular_large").addClass("is-sent")}})}(),function(){l.tab_button=$(".tabs_internos .tab_button"),l.tab_button.on("click",function(e){e.preventDefault();var i=$(this),n=parseInt(i.attr("data-legal-type"));i.parents(".tab-content").find(".tabs_internos .tab_button").removeClass("is-active"),i.addClass("is-active"),$(".SeleccionFinanciera-slide").slick("removeSlide",null,null,!0),viewModelDynamicContent.availableBanks(expressApp.populateArrayBanks(n)),$(".SeleccionFinanciera-slide").slick("unslick"),seleccionFinanciera.init(),seleccionFinanciera.refreshAllSlides(),r(),$("#"+viewModel.SelectedBankId).length?($(".SeleccionFinanciera-slide").slick("slickGoTo",$(".SeleccionFinanciera-item:has(#"+viewModel.SelectedBankId+")").data("slickIndex")||0),$("#"+viewModel.SelectedBankId).click()):$(".SeleccionFinanciera-item .link").eq(0).click(),4==n&&(viewModel.SelectedBankPaymentCode=$(".SeleccionFinanciera-item .link.seleccionado").data("paymentCode")),$("div.cicn i.icona_mail").removeClass("is-sent"),$("div.cicn i.icona_celular").removeClass("is-sent")})}(),function(){4==viewModelDynamicContent.Country.Banks[0].LegalType&&$(".tabs_internos a:last-child").click()}()});

//contador_tiempo.js
function contador_tiempo(n,o,e){var t=$("#"+n),i=$("#"+o),r=$("#"+e),s={};s.segundos=viewModelDynamicContent.LeftTime.Seconds,s.min=viewModelDynamicContent.LeftTime.Minutes,s.hor=viewModelDynamicContent.LeftTime.Hours;var m=s.min<10?"0"+s.min:s.min;i.text(m);var d=s.hor<10?"0"+s.hor:s.hor;t.text(d);var a=s.segundos<10?"0"+s.segundos:s.segundos;r.text(a),s.contador=function(){if(0===s.min&&0==s.hor&&0===s.segundos)return void clearInterval(u);if(s.hor>=0&&s.min>=0){s.segundos>0&&s.segundos--;var n=s.segundos;s.segundos<10&&(n="0"+n),r.text(n),0===s.segundos&&(0===s.min&&s.hor>0&&(s.hor--,txt_hora=s.hor,s.hor<10&&(txt_hora="0"+s.hor),t.text(txt_hora),s.min=59),s.min>0&&(s.min--,m=s.min,s.min<10&&(m="0"+s.min),i.text(m),s.segundos=59))}};var u=setInterval(function(){s.contador()},1e3)}
